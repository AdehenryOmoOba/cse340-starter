<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>
        <%= title %>
    </title>
    <style>
        .register-container {
            max-width: 400px;
            margin: 2rem auto;
            padding: 2rem;
            background: #fff;
            border-radius: 1rem;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        }

        .register-container h1 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: #2c3e50;
        }

        .register-form label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .register-form input[type="text"],
        .register-form input[type="email"],
        .register-form input[type="password"] {
            width: 100%;
            padding: 0.7rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 0.5rem;
            font-size: 1rem;
        }

        .register-form button {
            width: 100%;
            padding: 0.8rem;
            background: #0050b3;
            color: #fff;
            border: none;
            border-radius: 0.5rem;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }

        .register-form button:hover {
            background: #003974;
        }

        .password-helper {
            font-size: 0.95rem;
            color: #555;
            margin-bottom: 1rem;
        }

        .messages {
            margin-bottom: 1rem;
        }

        .register-form input:invalid {
            border-color: #e74c3c;
            background: #fff6f6;
        }

        .register-form input:valid {
            border-color: #2ecc40;
            background: #f6fff6;
        }

        .register-form input:focus:invalid {
            outline: 2px solid #e74c3c;
        }

        .register-form input:focus:valid {
            outline: 2px solid #2ecc40;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const passwordInput = document.getElementById('account_password');
            const requirements = {
                length: document.getElementById('pw-length'),
                uppercase: document.getElementById('pw-uppercase'),
                number: document.getElementById('pw-number'),
                special: document.getElementById('pw-special')
            };
            passwordInput.addEventListener('input', function () {
                const value = passwordInput.value;
                // Length
                if (value.length >= 12) {
                    requirements.length.classList.add('valid');
                    requirements.length.classList.remove('invalid');
                } else {
                    requirements.length.classList.remove('valid');
                    requirements.length.classList.add('invalid');
                }
                // Uppercase
                if (/[A-Z]/.test(value)) {
                    requirements.uppercase.classList.add('valid');
                    requirements.uppercase.classList.remove('invalid');
                } else {
                    requirements.uppercase.classList.remove('valid');
                    requirements.uppercase.classList.add('invalid');
                }
                // Number
                if (/\d/.test(value)) {
                    requirements.number.classList.add('valid');
                    requirements.number.classList.remove('invalid');
                } else {
                    requirements.number.classList.remove('valid');
                    requirements.number.classList.add('invalid');
                }
                // Special character
                if (/[^a-zA-Z0-9]/.test(value)) {
                    requirements.special.classList.add('valid');
                    requirements.special.classList.remove('invalid');
                } else {
                    requirements.special.classList.remove('valid');
                    requirements.special.classList.add('invalid');
                }
            });
        });
    </script>
    <style>
        .password-helper {
            list-style: none;
            padding-left: 1.2em;
            margin-bottom: 0.5rem;
            margin-top: 0.2rem;
        }

        .password-helper li {
            color: #e74c3c;
            margin-bottom: 0.2rem;
            font-size: 0.7rem;
            font-weight: 400;
            transition: color 0.2s;
            position: relative;
            padding-left: 1.3em;
        }

        .password-helper li::before {
            content: '\2022';
            /* bullet */
            position: absolute;
            left: 0;
            color: #e74c3c;
            font-size: 1em;
            transition: color 0.2s, content 0.2s;
        }

        .password-helper li.valid {
            color: #2ecc40;
            font-weight: 600;
        }

        .password-helper li.valid::before {
            content: '\2713';
            /* checkmark */
            color: #2ecc40;
            font-size: 1.1em;
        }
    </style>
</head>

<body>
    <div class="register-container">
        <h1>
            <%= title %>
        </h1>
        <%- messages() %>
            <% if (errors) { %>
                <ul class="notice">
                    <% errors.array().forEach(error=> { %>
                        <li>
                            <%= error.msg %>
                        </li>
                        <% }) %>
                </ul>
                <% } %>
                    <form class="register-form" action="/account/register" method="post">
                        <label for="account_firstname">First Name</label>
                        <input type="text" id="account_firstname" name="account_firstname" required
                            autocomplete="given-name" value="<%= locals.account_firstname %>">
                        <label for="account_lastname">Last Name</label>
                        <input type="text" id="account_lastname" name="account_lastname" required
                            autocomplete="family-name" value="<%= locals.account_lastname %>">
                        <label for="account_email">Email Address</label>
                        <input type="email" id="account_email" name="account_email" required autocomplete="username"
                            value="<%= locals.account_email %>">
                        <label for="account_password">Password</label>
                        <input type="password" id="account_password" name="account_password" required
                            pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{12,}$"
                            autocomplete="new-password">
                        <ul id="password-requirements" class="password-helper">
                            <li id="pw-length" class="invalid">At least 12 characters</li>
                            <li id="pw-uppercase" class="invalid">1 uppercase letter</li>
                            <li id="pw-number" class="invalid">1 number</li>
                            <li id="pw-special" class="invalid">1 special character</li>
                        </ul>
                        <button type="submit">Register</button>
                    </form>
                    <div style="text-align:center; margin-top:1rem;">
                        Already have an account? <a href="/account/login">Login here</a>.
                    </div>
    </div>
</body>

</html>